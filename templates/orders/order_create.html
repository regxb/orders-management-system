{% extends 'base.html' %}
{% load crispy_forms_tags %}
{% block content %}
<div class="container mt-5">
    <h2 class="text-center mb-4">
        {% if form.instance.pk %}
            –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–∫–∞–∑
        {% else %}
            –ù–æ–≤—ã–π –∑–∞–∫–∞–∑
        {% endif %}
    </h2>

    <form action="" method="post" class="bg-light p-4 rounded shadow-sm col-md-8 mx-auto">
        {% csrf_token %}

        <!-- –ø–æ–ª–µ –¥–ª—è –≤–≤–æ–¥–∞ –Ω–æ–º–µ—Ä–∞ —Å—Ç–æ–ª–∞ -->
        <div class="mb-3">
            {{ form|crispy }}
        </div>

        <!-- –≤—ã–±–æ—Ä –±–ª—é–¥–∞ –∏ —Ü–µ–Ω—ã -->
        <div id="items-container" class="mb-3">
            <div class="input-group mb-3 item-select">
                <label class="input-group-text">–ë–ª—é–¥–æ</label>
                <select class="form-select" name="items">
                    <option selected value="">–ë–ª—é–¥–æ –Ω–µ –≤—ã–±—Ä–∞–Ω–æ...</option>
                    {% for item in items %}
                        <option value="{{ item.id }}">{{ item.name }}</option>
                    {% endfor %}
                </select>
                <span class="input-group-text">–¶–µ–Ω–∞</span>
                <input type="number" class="form-control" name="prices" min="1" max="99999999" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ü–µ–Ω—É">
            </div>
        </div>

        <!-- –¥–æ–±–∞–≤–∏—Ç—å –±–ª—é–¥–æ -->
        <button type="button" class="btn btn-outline-secondary mb-3" id="add-item">‚ûï –î–æ–±–∞–≤–∏—Ç—å –µ—â–µ –æ–¥–Ω–æ –±–ª—é–¥–æ</button>

        <!-- –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–æ—Ä–º—É -->
        <div class="mt-4">
            <button type="submit" class="btn btn-success">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            <a href="{% url 'order_list' %}" class="btn btn-secondary">‚Ü©Ô∏è –ù–∞–∑–∞–¥ –∫ –∑–∞–∫–∞–∑–∞–º</a>
        </div>
    </form>

    <!-- –≤—ã–≤–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏–π -->
    {% for message in messages %}
        <div class="alert alert-{{ message.tags }} mt-4 text-center col-12">
            {{ message }}
        </div>
    {% endfor %}
</div>

<script>
    document.getElementById("add-item").addEventListener("click", function () {
        let container = document.getElementById("items-container");
        let newItem = container.firstElementChild.cloneNode(true);
        newItem.querySelector("select").value = "";
        newItem.querySelector("input").value = "";
        container.appendChild(newItem);
    });
</script>
{% endblock %}
